schema: '2.0'
stages:
  fetch_ev:
    cmd: "poetry run python src/data/fetch_ev_data.py\ngit commit -am \"âš¡ Updated
      raw EV data on $(date) with DVC pipeline\" || true\ngit push || true\ndvc push
      || true\n"
    deps:
    - path: src/data/fetch_ev_data.py
      hash: md5
      md5: e4114650fc5ad3007d0e27ffc7f8a625
      size: 3284
    outs:
    - path: data/raw/ev/ljubljana_ev_availability_combined.json
      hash: md5
      md5: b6e9c9461322b8f40176baa0063bb617
      size: 36849
  preprocess_ev:
    cmd: "poetry run python src/data/preprocess_ev_data.py\ngit commit -am \"ðŸ§¹ Preprocessed
      EV data on $(date) with DVC pipeline\" || true\ngit push || true\ndvc push ||
      true\n"
    deps:
    - path: data/raw/ev/ljubljana_ev_availability_combined.json
      hash: md5
      md5: b6e9c9461322b8f40176baa0063bb617
      size: 36849
    - path: src/data/preprocess_ev_data.py
      hash: md5
      md5: fca402c49896198f1697bcd463994594
      size: 2678
    outs:
    - path: data/preprocessed/ev
      hash: md5
      md5: 2ab432071c9c32ec33b38a80632ee797.dir
      size: 300215
      nfiles: 41
  validate_ev_data:
    cmd: "cd gx && poetry run python run_checkpoint.py\n"
    deps:
    - path: data/preprocessed/ev/
      hash: md5
      md5: 2ab432071c9c32ec33b38a80632ee797.dir
      size: 300215
      nfiles: 41
    - path: gx/great_expectations.yml
      hash: md5
      md5: a16393d260c28ffd4c893a0df7b30eb3
      size: 8902
    - path: gx/run_checkpoint.py
      hash: md5
      md5: 2a1d984387d26fdbd91f845c7e95aba4
      size: 3831
    outs:
    - path: gx/uncommitted
      hash: md5
      md5: 8c47d2a84cbdafe65ced5d2182725b6b.dir
      size: 84758023
      nfiles: 3919
  test_ev_data:
    cmd: "poetry run python src/data/test_ev_data.py\n"
    deps:
    - path: data/preprocessed/ev
      hash: md5
      md5: 2ab432071c9c32ec33b38a80632ee797.dir
      size: 300215
      nfiles: 41
    - path: src/data/test_ev_data.py
      hash: md5
      md5: bc384044bb131beb80d21f51db9ea27c
      size: 2593
    outs:
    - path: reports/ev_drift
      hash: md5
      md5: 752c1abd299041855552ff1af1397736.dir
      size: 157439484
      nfiles: 41
  train_ev:
    cmd: "poetry run python src/model/train_ev.py\ngit commit -am \"ðŸ¤– Trained EV model
      on $(date) via DVC pipeline\" || true\ngit push || true\ndvc push || true\n"
    deps:
    - path: data/preprocessed/ev
      hash: md5
      md5: d2c16ec3d43373b35f18c08679958bc8.dir
      size: 294665
      nfiles: 41
    - path: gx/uncommitted
      hash: md5
      md5: b1749858c021cf5640622b7c1aaed7ab.dir
      size: 83070386
      nfiles: 3837
    - path: reports/ev_drift
      hash: md5
      md5: 7a67b81500895a9ba33ecd5536e73054.dir
      size: 157441896
      nfiles: 41
    - path: src/model/preprocess.py
      hash: md5
      md5: b9da9b572d006dbd072da6c4799897f6
      size: 1711
    - path: src/model/train_ev.py
      hash: md5
      md5: 624a5f46759d234c5789b17da55366b4
      size: 5244
    params:
      params.yaml:
        train_ev.freq: 1h
        train_ev.random_state: 42
        train_ev.target: occupied
        train_ev.test_size: 4
        train_ev.window_size: 3
    outs:
    - path: models/
      hash: md5
      md5: c43cb3ac8ac398e04f6aa0dbfa6fe45e.dir
      size: 22544290
      nfiles: 164
  export_and_deploy_frontend:
    cmd: scripts\export_frontend.bat
    deps:
    - path: scripts\export_frontend.bat
      hash: md5
      md5: fdecf9923af07953625c385d498b75a4
      size: 901
      isexec: true
    - path: src/model/export_mlflow_models.py
      hash: md5
      md5: 77a8d7e94719d976ec7533dd613924fb
      size: 833
    outs:
    - path: public/ml_models.json
      hash: md5
      md5: 531620c85d585f8479ef468de9ebdf70
      size: 490370
